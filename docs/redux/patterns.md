---
title: Особенности написания компонентов redux
---

### Ленивые редюсеры и как защищать селекторы
При использовании функции replaceReducers из redux - в момент первого рендера редюсер может быть не подключен, также при очистке и подключении новых редюсеров при переходах по страницам может быть момент когда прежние редюсеры отключились а новые еще не подключились или наоборот. Это происходит из за того, что рендер блокировать нельзя из за отзывчивого UX и более высокого приоритета на рендер. Для избежания проблем при состояниях гонки - нужно указывать значение по умолчанию если редюсер не был выбран

```typescript
import { createSelector } from 'reselect';
import { MembersFormStateType, MembersFormStatePartType } from './_types';
import { initialState } from './reducer';
import { FORM_MEMBERS_REDUCER_NAME } from './_constants';

export const membersValuesStorageSelector = (store: MembersFormStatePartType) =>
  store[FORM_MEMBERS_REDUCER_NAME] || initialState;

export const membersFormIsLoadingSelector = createSelector(
  [membersValuesStorageSelector],
  ({ isLoading }: MembersFormStateType) => isLoading,
);
```

### Где держать бизнес логику приложения и различное форматтирование данных
 - Запрещается писать бизнес логику в редюсере и селекторах. Она должна писаться либо в сагах либо в контейнере.
 - В селекторах допускается только передача значений со стора и форматтирование значений (с выносом форматтеров в утилиты при необходимости)
 - Для форматтирования входящих данных должны быть использованы форматтеры в сагах


### Запрет на использование useSelector и useDispatch
Используется хок connect который позволяет более чистым и читаемым способом написать контейнерный компонент. Также этот контейнерный компонент при необходимости будет достаточно просто экспортировать и тестировать. Тестировать же connect не придется тк он относится к библиотеке redux